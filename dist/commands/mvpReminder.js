"use strict";var A=Object.create;var s=Object.defineProperty;var O=Object.getOwnPropertyDescriptor;var j=Object.getOwnPropertyNames;var F=Object.getPrototypeOf,B=Object.prototype.hasOwnProperty;var d=(e,t)=>s(e,"name",{value:t,configurable:!0});var I=(e,t)=>{for(var a in t)s(e,a,{get:t[a],enumerable:!0})},h=(e,t,a,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of j(t))!B.call(e,i)&&i!==a&&s(e,i,{get:()=>t[i],enumerable:!(n=O(t,i))||n.enumerable});return e};var r=(e,t,a)=>(a=e!=null?A(F(e)):{},h(t||!e||!e.__esModule?s(a,"default",{value:e,enumerable:!0}):a,e)),M=e=>h(s({},"__esModule",{value:!0}),e);var $={};I($,{default:()=>R});module.exports=M($);var o=require("@discordjs/voice"),v=require("@hyoretsu/utils"),w=require("discord.js"),y=r(require("ffmpeg-extract-frames")),b=r(require("m3u8stream")),u=r(require("fs")),S=r(require("path"));var f=r(require("google-tts-api")),m=r(require("fs")),g=r(require("path"));async function c(e,t){m.default.existsSync("./tmp")||m.default.mkdirSync("./tmp");let a=new Date().getTime(),n=g.default.resolve(`./tmp/${t}-${a}.mp3`);return m.default.writeFileSync(n,await f.getAudioBase64(e,{lang:"pt",slow:!1}),"base64"),n}d(c,"tts");var V={data:new w.SlashCommandBuilder().setName("mvp_reminder").setDescription("Starts the MVP bot by hopping into a voice channel.").addStringOption(e=>e.setName("streamer").setDescription("The twitch user that will be streaming and providing data to the bot.").setRequired(!0)).addChannelOption(e=>e.setName("channel").setDescription("The channel that will be used. Defaults to your current one.")).addNumberOption(e=>e.setName("resolution").setDescription("The resolution of MapleStory. Defaults to 1920x1080.").addChoices({name:"800x600",value:0},{name:"1024x768",value:1},{name:"1280x720",value:2},{name:"1366x768",value:3},{name:"1920x1080",value:4})).addStringOption(e=>e.setName("chat-lines").setDescription("The amount of lines being shown in the streamer's chat.")).addNumberOption(e=>e.setName("font-size").setDescription("The in-game font size you're using.").addChoices({name:"Default",value:0},{name:"Medium",value:1},{name:"Big",value:2},{name:"Large",value:3})),async execute(e){let{id:t,voiceAdapterCreator:a}=e.guild,n=e.options.getChannel("channel")??e.member.voice.channel;if(!n){await e.reply({content:"Invalid channel. Try again. (Join a voice channel or send one in the options)",ephemeral:!0});return}let{id:i}=n,x=await fetch(`https://pwn.sh/tools/streamapi.py?url=https%3A%2F%2Fwww.twitch.tv%2F${e.options.getString("streamer")}`),{urls:C}=await x.json(),D=Object.values(C).at(-1),T=(0,b.default)(D,{liveBuffer:1,parser:"m3u8"}).pipe(u.default.createWriteStream("videofile.mp4"));await(0,v.sleep)(2e3),T.end(),await(0,y.default)({input:"videofile.mp4",output:"frame-%d.jpg"}),await e.reply({content:"Hopping on for your grinding's joy.",ephemeral:!0});let l=(0,o.joinVoiceChannel)({channelId:i,guildId:t,adapterCreator:a});l.on(o.VoiceConnectionStatus.Disconnected,async()=>{u.default.rm(S.default.resolve("./tmp"),{force:!0,recursive:!0},()=>{})});let p=(0,o.createAudioPlayer)();l.subscribe(p);let N=await c("MVP daqui a 1 minuto cambada",t),P=(0,o.createAudioResource)(N);p.play(P),p.on(o.AudioPlayerStatus.Idle,()=>l.disconnect())}},R=V;
